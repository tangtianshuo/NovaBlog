---
title: NovaBlog äº‘ç«¯éƒ¨ç½²æŠ€æœ¯æ–¹æ¡ˆ
content: "# NovaBlog äº‘ç«¯éƒ¨ç½²æŠ€æœ¯æ–¹æ¡ˆ\n\næœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç» NovaBlog çš„äº‘ç«¯éƒ¨ç½²æ–¹æ¡ˆï¼Œæ¶µç›– Vercel + GitHub å­˜å‚¨ + Cloudflare çš„å®Œæ•´æŠ€æœ¯æ¶æ„ã€‚\n\n---\n\n## ç›®å½•\n\n1. [æ¶æ„æ¦‚è¿°](#æ¶æ„æ¦‚è¿°)\n2. [Vercel éƒ¨ç½²](#vercel-éƒ¨ç½²)\n3. [GitHub æ•°æ®å­˜å‚¨](#github-æ•°æ®å­˜å‚¨)\n4. [æœ¬åœ° IndexedDB + æ‰¹é‡åŒæ­¥](#æœ¬åœ°-indexeddb--æ‰¹é‡åŒæ­¥)\n5. [Cloudflare CDN åŠ é€Ÿ](#cloudflare-cdn-åŠ é€Ÿ)\n6. [ç¯å¢ƒå˜é‡é…ç½®](#ç¯å¢ƒå˜é‡é…ç½®)\n7. [æ•°æ®æµè¯´æ˜](#æ•°æ®æµè¯´æ˜)\n8. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)\n\n---\n\n## æ¶æ„æ¦‚è¿°\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                           ç”¨æˆ·                                    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                           â”‚\n                           â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                    Cloudflare (CDN + DNS)                        â”‚\nâ”‚                   blog.example.com                               â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                           â”‚\n                           â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                         Vercel                                   â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚\nâ”‚  â”‚   Vue 3 å‰ç«¯        â”‚    â”‚   Express API (Serverless)    â”‚  â”‚\nâ”‚  â”‚   (é™æ€èµ„æº)        â”‚â—„â”€â”€â–ºâ”‚   â€¢ è®¤è¯                      â”‚  â”‚\nâ”‚  â”‚                     â”‚    â”‚   â€¢ GitHub API åŒæ­¥            â”‚  â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â€¢ æ•°æ®è¯»å†™                   â”‚  â”‚\nâ”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                               â”‚\n                               â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                        GitHub ä»“åº“                               â”‚\nâ”‚  â€¢ data/documents/    (æ–‡ç« )                                   â”‚\nâ”‚  â€¢ data/projects/     (é¡¹ç›®)                                   â”‚\nâ”‚  â€¢ data/collections/  (åˆé›†)                                   â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n---\n\n## Vercel éƒ¨ç½²\n\n### éƒ¨ç½²æ­¥éª¤\n\n1. **æ¨é€ä»£ç åˆ° GitHub**\n```bash\ngit add .\ngit commit -m \"Configure for Vercel deployment\"\ngit push origin main\n```\n\n2. **åœ¨ Vercel å¯¼å…¥é¡¹ç›®**\n   - è®¿é—® [Vercel](https://vercel.com/new)\n   - ä½¿ç”¨ GitHub ç™»å½•\n   - å¯¼å…¥ NovaBlog ä»“åº“\n   - é…ç½®ï¼š\n     - Framework Preset: `Other`\n     - Build Command: `npm run vercel-build`\n     - Output Directory: `dist`\n     - Install Command: `npm install`\n\n3. **é…ç½®ç¯å¢ƒå˜é‡**ï¼ˆè¯¦è§ä¸‹æ–‡ï¼‰\n\n4. **éƒ¨ç½²å®Œæˆ**\n\n### vercel.json é…ç½®\n\n```json\n{\n  \"version\": 2,\n  \"builds\": [\n    {\n      \"src\": \"package.json\",\n      \"use\": \"@vercel/static-build\",\n      \"config\": {\n        \"distDir\": \"dist\"\n      }\n    },\n    {\n      \"src\": \"api/index.ts\",\n      \"use\": \"@vercel/node\",\n      \"config\": {\n        \"maxDuration\": 30\n      }\n    }\n  ],\n  \"rewrites\": [\n    { \"source\": \"/api/(.*)\", \"destination\": \"/api/index.ts\" },\n    { \"source\": \"/uploads/(.*)\", \"destination\": \"/uploads/$1\" },\n    { \"source\": \"/((?!api/|uploads/|assets/|.*\\\\..*).*)\", \"destination\": \"/index.html\" }\n  ]\n}\n```\n\n---\n\n## GitHub æ•°æ®å­˜å‚¨\n\n### å­˜å‚¨ç»“æ„\n\n```\ndata/\nâ”œâ”€â”€ documents/\nâ”‚   â”œâ”€â”€ draft/\nâ”‚   â”‚   â””â”€â”€ article-title/\nâ”‚   â”‚       â””â”€â”€ index.md\nâ”‚   â””â”€â”€ published/\nâ”‚       â””â”€â”€ article-title/\nâ”‚           â””â”€â”€ index.md\nâ”œâ”€â”€ projects/\nâ”‚   â””â”€â”€ project-name/\nâ”‚       â””â”€â”€ index.md\nâ””â”€â”€ collections/\n    â””â”€â”€ collection-name/\n        â””â”€â”€ index.md\n```\n\n### æ–‡ä»¶æ ¼å¼\n\nä½¿ç”¨ Frontmatter æ ¼å¼å­˜å‚¨ï¼š\n\n```markdown\n---\nid: 550e8400-e29b-41d4-a716-446655440000\ntitle: æ–‡ç« æ ‡é¢˜\nslug: article-slug\ndescription: æ–‡ç« æè¿°\nstatus: published\ncreatedAt: 2024-01-01T00:00:00.000Z\nupdatedAt: 2024-01-02T00:00:00.000Z\npublishedAt: 2024-01-02T00:00:00.000Z\ntags:\n  - æŠ€æœ¯\n  - Vue\ncategory: tech\nauthor: admin\n---\n\næ–‡ç« å†…å®¹...\n```\n\n### GitHub API åŒæ­¥\n\nåç«¯é€šè¿‡ GitHub API è¿›è¡Œæ–‡ä»¶æ“ä½œï¼š\n\n```typescript\n// api/utils/githubSync.ts\nconst GITHUB_API_BASE = \"https://api.github.com\"\n\nasync function createOrUpdateFile(file: {\n  path: string\n  content: string\n  message: string\n  sha?: string\n}): Promise<boolean> {\n  const sha = await getFileSha(file.path)\n\n  const body = {\n    message: file.message,\n    content: Buffer.from(file.content).toString(\"base64\"),\n    branch: BRANCH,\n    ...(sha && { sha }),\n  }\n\n  const response = await fetch(\n    `${GITHUB_API_BASE}/repos/${OWNER}/${REPO}/contents/${file.path}`,\n    {\n      method: \"PUT\",\n      headers: await getHeaders(),\n      body: JSON.stringify(body),\n    },\n  )\n\n  return response.ok\n}\n```\n\n---\n\n## æœ¬åœ° IndexedDB + æ‰¹é‡åŒæ­¥\n\n### è§£å†³çš„é—®é¢˜\n\nVercel æ˜¯æ— æœåŠ¡å™¨å¹³å°ï¼Œ**ä¸å…è®¸åœ¨è¿è¡Œæ—¶å†™å…¥æ–‡ä»¶ç³»ç»Ÿ**ã€‚ç›´æ¥ä¿å­˜æ–‡æ¡£ä¼šå¤±è´¥ã€‚\n\n### è§£å†³æ–¹æ¡ˆ\n\né‡‡ç”¨æœ¬åœ°å­˜å‚¨ + æ‰¹é‡åŒæ­¥çš„æ¶æ„ï¼š\n\n1. **ä¿å­˜æ—¶**ï¼šæ•°æ®å­˜å‚¨åˆ°æµè§ˆå™¨ IndexedDB\n2. **åŒæ­¥æ—¶**ï¼šæ‰¹é‡æäº¤åˆ° GitHub\n\n### æ ¸å¿ƒä»£ç \n\n#### IndexedDB å·¥å…·ç±»\n\n```typescript\n// src/utils/syncDB.ts\nclass IndexedDBManager {\n  private db: IDBDatabase | null = null\n\n  async init(): Promise<void> {\n    return new Promise((resolve, reject) => {\n      const request = indexedDB.open(\"novablog-sync\", 1)\n\n      request.onupgradeneeded = (event) => {\n        const db = (event.target as IDBOpenDBRequest).result\n        db.createObjectStore(\"syncQueue\", { keyPath: \"id\" })\n      }\n\n      request.onsuccess = () => {\n        this.db = request.result\n        resolve()\n      }\n    })\n  }\n\n  async saveDocument(doc: { metadata: Record<string, unknown>; content: string }, id?: string): Promise<string> {\n    const docId = id || crypto.randomUUID()\n    await this.addToQueue({\n      id: docId,\n      type: \"document\",\n      action: id ? \"update\" : \"create\",\n      data: doc,\n      timestamp: Date.now(),\n    })\n    return docId\n  }\n\n  async getQueue(): Promise<SyncItem[]> {\n    // è·å–æ‰€æœ‰å¾…åŒæ­¥é¡¹\n  }\n\n  async clearQueue(): Promise<void> {\n    // åŒæ­¥æˆåŠŸåæ¸…ç©ºé˜Ÿåˆ—\n  }\n}\n\nexport const syncDB = new IndexedDBManager()\n```\n\n#### åŒæ­¥ API\n\n```typescript\n// api/routes/sync.ts\nrouter.post(\"/\", authenticateToken, async (req, res) => {\n  const { items } = req.body\n\n  for (const item of items) {\n    if (item.type === \"document\") {\n      const metadata = item.data.metadata\n      const filePath = getDocumentPath(metadata)\n      const fileContent = matter.stringify(content, metadata)\n\n      await createOrUpdateFile({\n        path: filePath,\n        content: fileContent,\n        message: generateCommitMessage(item.action, \"document\", title),\n      })\n    }\n  }\n\n  res.json({ success: true, message: \"åŒæ­¥å®Œæˆ\" })\n})\n```\n\n### å‰ç«¯ç•Œé¢\n\nåœ¨ç®¡ç†é¡µé¢æ·»åŠ \"åŒæ­¥åˆ° GitHub\"æŒ‰é’®ï¼š\n\n```vue\n<template>\n  <button @click=\"syncToGitHub\" :disabled=\"syncing\">\n    <Loader2 v-if=\"syncing\" class=\"animate-spin\" />\n    <GitBranch v-else />\n    {{ syncing ? \"åŒæ­¥ä¸­...\" : \"åŒæ­¥åˆ°GitHub\" }}\n    <span v-if=\"pendingCount > 0\" class=\"badge\">{{ pendingCount }}</span>\n  </button>\n</template>\n```\n\n### æ•°æ®æ¥æºæ ‡ç­¾\n\nè¡¨æ ¼ä¸­æ˜¾ç¤ºæ•°æ®æ¥æºçŠ¶æ€ï¼š\n\n| çŠ¶æ€ | æ ‡ç­¾ | è¯´æ˜ |\n|------|------|------|\n| æœ¬åœ°æ–°å¢ | \U0001F7E1 é»„è‰² | æ–°åˆ›å»ºè¿˜æœªåŒæ­¥ |\n| æœ¬åœ°æ›´æ–° | \U0001F7E0 æ©™è‰² | å·²ä¿®æ”¹è¿˜æœªåŒæ­¥ |\n| å·²åŒæ­¥ | â¬œ ç°è‰² | å·²ç»åŒæ­¥åˆ° GitHub |\n\n### å‘å¸ƒæ—¶è‡ªåŠ¨æ¸…ç†è‰ç¨¿\n\n```typescript\n// å‘å¸ƒæ–‡æ¡£æ—¶\nif (status === \"published\") {\n  // 1. æ£€æŸ¥ GitHub ä¸Šæ˜¯å¦å­˜åœ¨è‰ç¨¿\n  const draftPath = `data/documents/draft/${docId}/index.md`\n  const draftContent = await getFile(draftPath)\n\n  // 2. å¦‚æœå­˜åœ¨ï¼Œå…ˆåˆ é™¤è‰ç¨¿\n  if (draftContent) {\n    await deleteFile({\n      path: draftPath,\n      message: `åˆ é™¤è‰ç¨¿: ${title} (å·²å‘å¸ƒ)`,\n    })\n  }\n\n  // 3. åˆ›å»ºå‘å¸ƒç‰ˆæœ¬\n  await createOrUpdateFile({ ... })\n}\n```\n\n### ID å†²çªæ£€æµ‹\n\n```typescript\n// å‰ç«¯å‘å¸ƒæ—¶æ£€æµ‹\nif (status === \"published\") {\n  const localDocs = await syncDB.getLocalDocuments()\n  const existingDraft = localDocs.find(\n    d => d.id === docId && d.metadata.status === \"draft\"\n  )\n  if (existingDraft) {\n    error(\"æ— æ³•å‘å¸ƒï¼šæœ¬åœ°å­˜åœ¨ç›¸åŒIDçš„è‰ç¨¿\")\n    return\n  }\n}\n```\n\n---\n\n## Cloudflare CDN åŠ é€Ÿ\n\n### DNS é…ç½®\n\nåœ¨ Cloudflare æ§åˆ¶å°æ·»åŠ  DNS è®°å½•ï¼š\n\n| ç±»å‹ | åç§° | å€¼ | è¯´æ˜ |\n|------|------|-----|------|\n| CNAME | blog | cname.vercel-dns.com | åšå®¢åŸŸå |\n\n### ç¼“å­˜ç­–ç•¥\n\n1. **é™æ€èµ„æº**ï¼ˆå›¾ç‰‡/CSS/JSï¼‰ï¼šé•¿æœŸç¼“å­˜\n2. **HTML é¡µé¢**ï¼šä¸ç¼“å­˜æˆ–çŸ­æœŸç¼“å­˜\n3. **API è¯·æ±‚**ï¼šä¸ç¼“å­˜\n\n### SSL/TLS é…ç½®\n\n1. åœ¨ Cloudflare ä¸­å¯ç”¨ \"Full\" æˆ– \"Flexible\" æ¨¡å¼\n2. Vercel ä¼šè‡ªåŠ¨é…ç½® SSL è¯ä¹¦\n\n---\n\n## ç¯å¢ƒå˜é‡é…ç½®\n\n### Vercel ç¯å¢ƒå˜é‡\n\n| å˜é‡å | ç¤ºä¾‹å€¼ | è¯´æ˜ |\n|--------|--------|------|\n| `JWT_SECRET` | `your-secret-key` | JWT è®¤è¯å¯†é’¥ |\n| `SESSION_SECRET` | `your-session-secret` | ä¼šè¯å¯†é’¥ |\n| `VITE_API_URL` | (ç•™ç©º) | ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ç›¸å¯¹è·¯å¾„ |\n| `GITHUB_TOKEN` | `ghp_xxx` | GitHub Personal Access Token |\n| `GITHUB_OWNER` | `your-username` | GitHub ç”¨æˆ·å |\n| `GITHUB_REPO` | `novablog` | ä»“åº“åç§° |\n| `GITHUB_BRANCH` | `main` | åˆ†æ”¯åç§° |\n\n### GitHub Token åˆ›å»ºæ­¥éª¤\n\n1. æ‰“å¼€ GitHub â†’ Settings â†’ Developer settings â†’ Personal access tokens â†’ Tokens (classic)\n2. ç‚¹å‡» \"Generate new token (classic)\"\n3. é…ç½®ï¼š\n   - Note: `NovaBlog Vercel`\n   - Expiration: å»ºè®® 90 å¤©\n   - Scopes: å‹¾é€‰ `repo` (å®Œæ•´ä»“åº“è®¿é—®)\n4. ç”Ÿæˆåå¤åˆ¶ Token\n\n---\n\n## æ•°æ®æµè¯´æ˜\n\n### å·¥ä½œæµç¨‹\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                         ç”¨æˆ·æ“ä½œ                                 â”‚\nâ”‚  åˆ›å»º/ç¼–è¾‘/åˆ é™¤ æ–‡æ¡£/é¡¹ç›®/åˆé›†                                   â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                             â”‚\n                             â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                      IndexedDB (æœ¬åœ°)                           â”‚\nâ”‚  â€¢ æ•°æ®ä¿å­˜åˆ°æµè§ˆå™¨æœ¬åœ°å­˜å‚¨                                        â”‚\nâ”‚  â€¢ æ˜¾ç¤º\"æœ¬åœ°æ–°å¢\"/\"æœ¬åœ°æ›´æ–°\"æ ‡ç­¾                                  â”‚\nâ”‚  â€¢ æ”¯æŒç¦»çº¿ç¼–è¾‘                                                   â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                             â”‚\n                             â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                     ç‚¹å‡»\"åŒæ­¥åˆ°GitHub\"                           â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                             â”‚\n                             â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                      Vercel Serverless                          â”‚\nâ”‚  â€¢ æ¥æ”¶åŒæ­¥è¯·æ±‚                                                   â”‚\nâ”‚  â€¢ è°ƒç”¨ GitHub API                                               â”‚\nâ”‚  â€¢ æ‰¹é‡æ‰§è¡Œåˆ›å»º/æ›´æ–°/åˆ é™¤æ“ä½œ                                      â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                             â”‚\n                             â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                        GitHub ä»“åº“                              â”‚\nâ”‚  â€¢ data/documents/                                              â”‚\nâ”‚  â€¢ data/projects/                                               â”‚\nâ”‚  â€¢ data/collections/                                            â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                             â”‚\n                             â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                      Vercel è‡ªåŠ¨éƒ¨ç½²                             â”‚\nâ”‚  â€¢ GitHub push è§¦å‘éƒ¨ç½²                                          â”‚\nâ”‚  â€¢ æ›´æ–°ç½‘ç«™å†…å®¹                                                   â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n### å‘å¸ƒæ—¶ç‰¹æ®Šå¤„ç†\n\n```\nç”¨æˆ·ç‚¹å‡»\"å‘å¸ƒ\"\n     â”‚\n     â–¼\næ£€æŸ¥æœ¬åœ°æ˜¯å¦æœ‰ç›¸åŒIDçš„è‰ç¨¿\n     â”‚\n     â”œâ”€ æœ‰ â”€â”€â†’ é˜»æ­¢å‘å¸ƒï¼Œæç¤ºå†²çª\n     â”‚\n     â””â”€ æ—  â”€â”€â†’ æäº¤åˆ° GitHub\n                 â”‚\n                 â–¼\n           æ£€æŸ¥ GitHub ä¸Šæ˜¯å¦æœ‰è‰ç¨¿\n                 â”‚\n                 â”œâ”€ æœ‰ â”€â”€â†’ å…ˆåˆ é™¤è‰ç¨¿æ–‡ä»¶\n                 â”‚\n                 â””â”€ æ— \n                 â”‚\n                 â–¼\n           åˆ›å»º/æ›´æ–°å‘å¸ƒç‰ˆæœ¬\n```\n\n---\n\n## å¸¸è§é—®é¢˜\n\n### Q: éƒ¨ç½²åé¡µé¢ç©ºç™½\n\nA: æ£€æŸ¥ `vercel.json` é…ç½®ï¼Œç¡®ä¿ `base` è·¯å¾„æ­£ç¡®ã€‚\n\n### Q: API è¯·æ±‚å¤±è´¥\n\nA: æ£€æŸ¥ç¯å¢ƒå˜é‡é…ç½®ã€‚ç”Ÿäº§ç¯å¢ƒä¸‹ API ä½¿ç”¨ç›¸å¯¹è·¯å¾„ `/api`ã€‚\n\n### Q: GitHub åŒæ­¥å¤±è´¥\n\nA: æ£€æŸ¥ç¯å¢ƒå˜é‡ï¼š\n- `GITHUB_TOKEN` æ˜¯å¦æ­£ç¡®\n- `GITHUB_OWNER` æ˜¯å¦æ˜¯ä½ çš„ GitHub ç”¨æˆ·å\n- `GITHUB_REPO` æ˜¯å¦å­˜åœ¨ä¸”ä½ æœ‰æƒé™\n- Token æ˜¯å¦æœ‰ `repo` æƒé™\n\n### Q: ä¸Šä¼ å›¾ç‰‡å¤±è´¥\n\nA: Vercel ä¸æ”¯æŒæŒä¹…åŒ–æ–‡ä»¶å­˜å‚¨ã€‚è§£å†³æ–¹æ¡ˆï¼š\n- å°†å›¾ç‰‡æ”¾åˆ° `public/images/` ç›®å½•ï¼Œé€šè¿‡ Git æäº¤\n- ä½¿ç”¨ Cloudflare R2ã€AWS S3 ç­‰å¤–éƒ¨å­˜å‚¨\n\n### Q: å¦‚ä½•æ›´æ–°å†…å®¹\n\nA:\n- **æ–¹æ³• 1**ï¼šç›´æ¥ä¿®æ”¹ `data/` ç›®å½•ï¼Œæäº¤åˆ° Git\n- **æ–¹æ³• 2**ï¼šä½¿ç”¨ç®¡ç†é¢æ¿ç¼–è¾‘ï¼Œæ‰¹é‡åŒæ­¥åˆ° GitHub\n\n---\n\n## ç”Ÿäº§ç¯å¢ƒå»ºè®®\n\n1. **ä½¿ç”¨ Vercel Pro** - è·å–æ›´å¤š Serverless å‡½æ•°è°ƒç”¨\n2. **é…ç½® Cloudflare** - è·å– CDN åŠ é€Ÿå’Œå®‰å…¨é˜²æŠ¤\n3. **å®šæœŸç»­æœŸ Token** - GitHub Token åˆ°æœŸå‰æ›´æ–°\n4. **å®šæœŸå¤‡ä»½** - å°† data ç›®å½•å¤‡ä»½åˆ°æœ¬åœ°\n\n---\n\n## ç›¸å…³æ–‡ä»¶\n\n| æ–‡ä»¶ | è¯´æ˜ |\n|------|------|\n| `api/routes/sync.ts` | æ‰¹é‡åŒæ­¥ API |\n| `api/utils/githubSync.ts` | GitHub API å·¥å…· |\n| `src/utils/syncDB.ts` | IndexedDB å·¥å…·ç±» |\n| `src/pages/Admin.vue` | ç®¡ç†é¡µé¢ï¼ˆå«åŒæ­¥æŒ‰é’®ï¼‰|\n| `src/pages/Editor.vue` | ç¼–è¾‘å™¨ |\n| `vercel.json` | Vercel é…ç½®æ–‡ä»¶ |\n"
description: ä½¿ç”¨Vercelåšå†…å®¹æ‰˜ç®¡ï¼ŒCloudflareåšDNSè§£æï¼ŒgithubRepoåšæ–‡æ¡£å­˜å‚¨ã€‚
tags:
  - Vercel
  - Cloudflare
  - GithubRepo
status: draft
id: 2685437d-3925-4e50-a236-08b9d1f666a0
slug: novablog-äº‘ç«¯éƒ¨ç½²æŠ€æœ¯æ–¹æ¡ˆ
createdAt: '2026-03-01T03:22:17.881Z'
author: admin
---
# NovaBlog äº‘ç«¯éƒ¨ç½²æŠ€æœ¯æ–¹æ¡ˆ

æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç» NovaBlog çš„äº‘ç«¯éƒ¨ç½²æ–¹æ¡ˆï¼Œæ¶µç›– Vercel + GitHub å­˜å‚¨ + Cloudflare çš„å®Œæ•´æŠ€æœ¯æ¶æ„ã€‚

---

## ç›®å½•

1. [æ¶æ„æ¦‚è¿°](#æ¶æ„æ¦‚è¿°)
2. [Vercel éƒ¨ç½²](#vercel-éƒ¨ç½²)
3. [GitHub æ•°æ®å­˜å‚¨](#github-æ•°æ®å­˜å‚¨)
4. [æœ¬åœ° IndexedDB + æ‰¹é‡åŒæ­¥](#æœ¬åœ°-indexeddb--æ‰¹é‡åŒæ­¥)
5. [Cloudflare CDN åŠ é€Ÿ](#cloudflare-cdn-åŠ é€Ÿ)
6. [ç¯å¢ƒå˜é‡é…ç½®](#ç¯å¢ƒå˜é‡é…ç½®)
7. [æ•°æ®æµè¯´æ˜](#æ•°æ®æµè¯´æ˜)
8. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## æ¶æ„æ¦‚è¿°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ç”¨æˆ·                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Cloudflare (CDN + DNS)                        â”‚
â”‚                   blog.example.com                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Vercel                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Vue 3 å‰ç«¯        â”‚    â”‚   Express API (Serverless)    â”‚  â”‚
â”‚  â”‚   (é™æ€èµ„æº)        â”‚â—„â”€â”€â–ºâ”‚   â€¢ è®¤è¯                      â”‚  â”‚
â”‚  â”‚                     â”‚    â”‚   â€¢ GitHub API åŒæ­¥            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â€¢ æ•°æ®è¯»å†™                   â”‚  â”‚
â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        GitHub ä»“åº“                               â”‚
â”‚  â€¢ data/documents/    (æ–‡ç« )                                   â”‚
â”‚  â€¢ data/projects/     (é¡¹ç›®)                                   â”‚
â”‚  â€¢ data/collections/  (åˆé›†)                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Vercel éƒ¨ç½²

### éƒ¨ç½²æ­¥éª¤

1. **æ¨é€ä»£ç åˆ° GitHub**
```bash
git add .
git commit -m "Configure for Vercel deployment"
git push origin main
```

2. **åœ¨ Vercel å¯¼å…¥é¡¹ç›®**
   - è®¿é—® [Vercel](https://vercel.com/new)
   - ä½¿ç”¨ GitHub ç™»å½•
   - å¯¼å…¥ NovaBlog ä»“åº“
   - é…ç½®ï¼š
     - Framework Preset: `Other`
     - Build Command: `npm run vercel-build`
     - Output Directory: `dist`
     - Install Command: `npm install`

3. **é…ç½®ç¯å¢ƒå˜é‡**ï¼ˆè¯¦è§ä¸‹æ–‡ï¼‰

4. **éƒ¨ç½²å®Œæˆ**

### vercel.json é…ç½®

```json
{
  "version": 2,
  "builds": [
    {
      "src": "package.json",
      "use": "@vercel/static-build",
      "config": {
        "distDir": "dist"
      }
    },
    {
      "src": "api/index.ts",
      "use": "@vercel/node",
      "config": {
        "maxDuration": 30
      }
    }
  ],
  "rewrites": [
    { "source": "/api/(.*)", "destination": "/api/index.ts" },
    { "source": "/uploads/(.*)", "destination": "/uploads/$1" },
    { "source": "/((?!api/|uploads/|assets/|.*\\..*).*)", "destination": "/index.html" }
  ]
}
```

---

## GitHub æ•°æ®å­˜å‚¨

### å­˜å‚¨ç»“æ„

```
data/
â”œâ”€â”€ documents/
â”‚   â”œâ”€â”€ draft/
â”‚   â”‚   â””â”€â”€ article-title/
â”‚   â”‚       â””â”€â”€ index.md
â”‚   â””â”€â”€ published/
â”‚       â””â”€â”€ article-title/
â”‚           â””â”€â”€ index.md
â”œâ”€â”€ projects/
â”‚   â””â”€â”€ project-name/
â”‚       â””â”€â”€ index.md
â””â”€â”€ collections/
    â””â”€â”€ collection-name/
        â””â”€â”€ index.md
```

### æ–‡ä»¶æ ¼å¼

ä½¿ç”¨ Frontmatter æ ¼å¼å­˜å‚¨ï¼š

```markdown
---
id: 550e8400-e29b-41d4-a716-446655440000
title: æ–‡ç« æ ‡é¢˜
slug: article-slug
description: æ–‡ç« æè¿°
status: published
createdAt: 2024-01-01T00:00:00.000Z
updatedAt: 2024-01-02T00:00:00.000Z
publishedAt: 2024-01-02T00:00:00.000Z
tags:
  - æŠ€æœ¯
  - Vue
category: tech
author: admin
---

æ–‡ç« å†…å®¹...
```

### GitHub API åŒæ­¥

åç«¯é€šè¿‡ GitHub API è¿›è¡Œæ–‡ä»¶æ“ä½œï¼š

```typescript
// api/utils/githubSync.ts
const GITHUB_API_BASE = "https://api.github.com"

async function createOrUpdateFile(file: {
  path: string
  content: string
  message: string
  sha?: string
}): Promise<boolean> {
  const sha = await getFileSha(file.path)

  const body = {
    message: file.message,
    content: Buffer.from(file.content).toString("base64"),
    branch: BRANCH,
    ...(sha && { sha }),
  }

  const response = await fetch(
    `${GITHUB_API_BASE}/repos/${OWNER}/${REPO}/contents/${file.path}`,
    {
      method: "PUT",
      headers: await getHeaders(),
      body: JSON.stringify(body),
    },
  )

  return response.ok
}
```

---

## æœ¬åœ° IndexedDB + æ‰¹é‡åŒæ­¥

### è§£å†³çš„é—®é¢˜

Vercel æ˜¯æ— æœåŠ¡å™¨å¹³å°ï¼Œ**ä¸å…è®¸åœ¨è¿è¡Œæ—¶å†™å…¥æ–‡ä»¶ç³»ç»Ÿ**ã€‚ç›´æ¥ä¿å­˜æ–‡æ¡£ä¼šå¤±è´¥ã€‚

### è§£å†³æ–¹æ¡ˆ

é‡‡ç”¨æœ¬åœ°å­˜å‚¨ + æ‰¹é‡åŒæ­¥çš„æ¶æ„ï¼š

1. **ä¿å­˜æ—¶**ï¼šæ•°æ®å­˜å‚¨åˆ°æµè§ˆå™¨ IndexedDB
2. **åŒæ­¥æ—¶**ï¼šæ‰¹é‡æäº¤åˆ° GitHub

### æ ¸å¿ƒä»£ç 

#### IndexedDB å·¥å…·ç±»

```typescript
// src/utils/syncDB.ts
class IndexedDBManager {
  private db: IDBDatabase | null = null

  async init(): Promise<void> {
    return new Promise((resolve, reject) => {
      const request = indexedDB.open("novablog-sync", 1)

      request.onupgradeneeded = (event) => {
        const db = (event.target as IDBOpenDBRequest).result
        db.createObjectStore("syncQueue", { keyPath: "id" })
      }

      request.onsuccess = () => {
        this.db = request.result
        resolve()
      }
    })
  }

  async saveDocument(doc: { metadata: Record<string, unknown>; content: string }, id?: string): Promise<string> {
    const docId = id || crypto.randomUUID()
    await this.addToQueue({
      id: docId,
      type: "document",
      action: id ? "update" : "create",
      data: doc,
      timestamp: Date.now(),
    })
    return docId
  }

  async getQueue(): Promise<SyncItem[]> {
    // è·å–æ‰€æœ‰å¾…åŒæ­¥é¡¹
  }

  async clearQueue(): Promise<void> {
    // åŒæ­¥æˆåŠŸåæ¸…ç©ºé˜Ÿåˆ—
  }
}

export const syncDB = new IndexedDBManager()
```

#### åŒæ­¥ API

```typescript
// api/routes/sync.ts
router.post("/", authenticateToken, async (req, res) => {
  const { items } = req.body

  for (const item of items) {
    if (item.type === "document") {
      const metadata = item.data.metadata
      const filePath = getDocumentPath(metadata)
      const fileContent = matter.stringify(content, metadata)

      await createOrUpdateFile({
        path: filePath,
        content: fileContent,
        message: generateCommitMessage(item.action, "document", title),
      })
    }
  }

  res.json({ success: true, message: "åŒæ­¥å®Œæˆ" })
})
```

### å‰ç«¯ç•Œé¢

åœ¨ç®¡ç†é¡µé¢æ·»åŠ "åŒæ­¥åˆ° GitHub"æŒ‰é’®ï¼š

```vue
<template>
  <button @click="syncToGitHub" :disabled="syncing">
    <Loader2 v-if="syncing" class="animate-spin" />
    <GitBranch v-else />
    {{ syncing ? "åŒæ­¥ä¸­..." : "åŒæ­¥åˆ°GitHub" }}
    <span v-if="pendingCount > 0" class="badge">{{ pendingCount }}</span>
  </button>
</template>
```

### æ•°æ®æ¥æºæ ‡ç­¾

è¡¨æ ¼ä¸­æ˜¾ç¤ºæ•°æ®æ¥æºçŠ¶æ€ï¼š

| çŠ¶æ€ | æ ‡ç­¾ | è¯´æ˜ |
|------|------|------|
| æœ¬åœ°æ–°å¢ | ğŸŸ¡ é»„è‰² | æ–°åˆ›å»ºè¿˜æœªåŒæ­¥ |
| æœ¬åœ°æ›´æ–° | ğŸŸ  æ©™è‰² | å·²ä¿®æ”¹è¿˜æœªåŒæ­¥ |
| å·²åŒæ­¥ | â¬œ ç°è‰² | å·²ç»åŒæ­¥åˆ° GitHub |

### å‘å¸ƒæ—¶è‡ªåŠ¨æ¸…ç†è‰ç¨¿

```typescript
// å‘å¸ƒæ–‡æ¡£æ—¶
if (status === "published") {
  // 1. æ£€æŸ¥ GitHub ä¸Šæ˜¯å¦å­˜åœ¨è‰ç¨¿
  const draftPath = `data/documents/draft/${docId}/index.md`
  const draftContent = await getFile(draftPath)

  // 2. å¦‚æœå­˜åœ¨ï¼Œå…ˆåˆ é™¤è‰ç¨¿
  if (draftContent) {
    await deleteFile({
      path: draftPath,
      message: `åˆ é™¤è‰ç¨¿: ${title} (å·²å‘å¸ƒ)`,
    })
  }

  // 3. åˆ›å»ºå‘å¸ƒç‰ˆæœ¬
  await createOrUpdateFile({ ... })
}
```

### ID å†²çªæ£€æµ‹

```typescript
// å‰ç«¯å‘å¸ƒæ—¶æ£€æµ‹
if (status === "published") {
  const localDocs = await syncDB.getLocalDocuments()
  const existingDraft = localDocs.find(
    d => d.id === docId && d.metadata.status === "draft"
  )
  if (existingDraft) {
    error("æ— æ³•å‘å¸ƒï¼šæœ¬åœ°å­˜åœ¨ç›¸åŒIDçš„è‰ç¨¿")
    return
  }
}
```

---

## Cloudflare CDN åŠ é€Ÿ

### DNS é…ç½®

åœ¨ Cloudflare æ§åˆ¶å°æ·»åŠ  DNS è®°å½•ï¼š

| ç±»å‹ | åç§° | å€¼ | è¯´æ˜ |
|------|------|-----|------|
| CNAME | blog | cname.vercel-dns.com | åšå®¢åŸŸå |

### ç¼“å­˜ç­–ç•¥

1. **é™æ€èµ„æº**ï¼ˆå›¾ç‰‡/CSS/JSï¼‰ï¼šé•¿æœŸç¼“å­˜
2. **HTML é¡µé¢**ï¼šä¸ç¼“å­˜æˆ–çŸ­æœŸç¼“å­˜
3. **API è¯·æ±‚**ï¼šä¸ç¼“å­˜

### SSL/TLS é…ç½®

1. åœ¨ Cloudflare ä¸­å¯ç”¨ "Full" æˆ– "Flexible" æ¨¡å¼
2. Vercel ä¼šè‡ªåŠ¨é…ç½® SSL è¯ä¹¦

---

## ç¯å¢ƒå˜é‡é…ç½®

### Vercel ç¯å¢ƒå˜é‡

| å˜é‡å | ç¤ºä¾‹å€¼ | è¯´æ˜ |
|--------|--------|------|
| `JWT_SECRET` | `your-secret-key` | JWT è®¤è¯å¯†é’¥ |
| `SESSION_SECRET` | `your-session-secret` | ä¼šè¯å¯†é’¥ |
| `VITE_API_URL` | (ç•™ç©º) | ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ç›¸å¯¹è·¯å¾„ |
| `GITHUB_TOKEN` | `ghp_xxx` | GitHub Personal Access Token |
| `GITHUB_OWNER` | `your-username` | GitHub ç”¨æˆ·å |
| `GITHUB_REPO` | `novablog` | ä»“åº“åç§° |
| `GITHUB_BRANCH` | `main` | åˆ†æ”¯åç§° |

### GitHub Token åˆ›å»ºæ­¥éª¤

1. æ‰“å¼€ GitHub â†’ Settings â†’ Developer settings â†’ Personal access tokens â†’ Tokens (classic)
2. ç‚¹å‡» "Generate new token (classic)"
3. é…ç½®ï¼š
   - Note: `NovaBlog Vercel`
   - Expiration: å»ºè®® 90 å¤©
   - Scopes: å‹¾é€‰ `repo` (å®Œæ•´ä»“åº“è®¿é—®)
4. ç”Ÿæˆåå¤åˆ¶ Token

---

## æ•°æ®æµè¯´æ˜

### å·¥ä½œæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ç”¨æˆ·æ“ä½œ                                 â”‚
â”‚  åˆ›å»º/ç¼–è¾‘/åˆ é™¤ æ–‡æ¡£/é¡¹ç›®/åˆé›†                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      IndexedDB (æœ¬åœ°)                           â”‚
â”‚  â€¢ æ•°æ®ä¿å­˜åˆ°æµè§ˆå™¨æœ¬åœ°å­˜å‚¨                                        â”‚
â”‚  â€¢ æ˜¾ç¤º"æœ¬åœ°æ–°å¢"/"æœ¬åœ°æ›´æ–°"æ ‡ç­¾                                  â”‚
â”‚  â€¢ æ”¯æŒç¦»çº¿ç¼–è¾‘                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ç‚¹å‡»"åŒæ­¥åˆ°GitHub"                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Vercel Serverless                          â”‚
â”‚  â€¢ æ¥æ”¶åŒæ­¥è¯·æ±‚                                                   â”‚
â”‚  â€¢ è°ƒç”¨ GitHub API                                               â”‚
â”‚  â€¢ æ‰¹é‡æ‰§è¡Œåˆ›å»º/æ›´æ–°/åˆ é™¤æ“ä½œ                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        GitHub ä»“åº“                              â”‚
â”‚  â€¢ data/documents/                                              â”‚
â”‚  â€¢ data/projects/                                               â”‚
â”‚  â€¢ data/collections/                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Vercel è‡ªåŠ¨éƒ¨ç½²                             â”‚
â”‚  â€¢ GitHub push è§¦å‘éƒ¨ç½²                                          â”‚
â”‚  â€¢ æ›´æ–°ç½‘ç«™å†…å®¹                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å‘å¸ƒæ—¶ç‰¹æ®Šå¤„ç†

```
ç”¨æˆ·ç‚¹å‡»"å‘å¸ƒ"
     â”‚
     â–¼
æ£€æŸ¥æœ¬åœ°æ˜¯å¦æœ‰ç›¸åŒIDçš„è‰ç¨¿
     â”‚
     â”œâ”€ æœ‰ â”€â”€â†’ é˜»æ­¢å‘å¸ƒï¼Œæç¤ºå†²çª
     â”‚
     â””â”€ æ—  â”€â”€â†’ æäº¤åˆ° GitHub
                 â”‚
                 â–¼
           æ£€æŸ¥ GitHub ä¸Šæ˜¯å¦æœ‰è‰ç¨¿
                 â”‚
                 â”œâ”€ æœ‰ â”€â”€â†’ å…ˆåˆ é™¤è‰ç¨¿æ–‡ä»¶
                 â”‚
                 â””â”€ æ— 
                 â”‚
                 â–¼
           åˆ›å»º/æ›´æ–°å‘å¸ƒç‰ˆæœ¬
```

---

## å¸¸è§é—®é¢˜

### Q: éƒ¨ç½²åé¡µé¢ç©ºç™½

A: æ£€æŸ¥ `vercel.json` é…ç½®ï¼Œç¡®ä¿ `base` è·¯å¾„æ­£ç¡®ã€‚

### Q: API è¯·æ±‚å¤±è´¥

A: æ£€æŸ¥ç¯å¢ƒå˜é‡é…ç½®ã€‚ç”Ÿäº§ç¯å¢ƒä¸‹ API ä½¿ç”¨ç›¸å¯¹è·¯å¾„ `/api`ã€‚

### Q: GitHub åŒæ­¥å¤±è´¥

A: æ£€æŸ¥ç¯å¢ƒå˜é‡ï¼š
- `GITHUB_TOKEN` æ˜¯å¦æ­£ç¡®
- `GITHUB_OWNER` æ˜¯å¦æ˜¯ä½ çš„ GitHub ç”¨æˆ·å
- `GITHUB_REPO` æ˜¯å¦å­˜åœ¨ä¸”ä½ æœ‰æƒé™
- Token æ˜¯å¦æœ‰ `repo` æƒé™

### Q: ä¸Šä¼ å›¾ç‰‡å¤±è´¥

A: Vercel ä¸æ”¯æŒæŒä¹…åŒ–æ–‡ä»¶å­˜å‚¨ã€‚è§£å†³æ–¹æ¡ˆï¼š
- å°†å›¾ç‰‡æ”¾åˆ° `public/images/` ç›®å½•ï¼Œé€šè¿‡ Git æäº¤
- ä½¿ç”¨ Cloudflare R2ã€AWS S3 ç­‰å¤–éƒ¨å­˜å‚¨

### Q: å¦‚ä½•æ›´æ–°å†…å®¹

A:
- **æ–¹æ³• 1**ï¼šç›´æ¥ä¿®æ”¹ `data/` ç›®å½•ï¼Œæäº¤åˆ° Git
- **æ–¹æ³• 2**ï¼šä½¿ç”¨ç®¡ç†é¢æ¿ç¼–è¾‘ï¼Œæ‰¹é‡åŒæ­¥åˆ° GitHub

---

## ç”Ÿäº§ç¯å¢ƒå»ºè®®

1. **ä½¿ç”¨ Vercel Pro** - è·å–æ›´å¤š Serverless å‡½æ•°è°ƒç”¨
2. **é…ç½® Cloudflare** - è·å– CDN åŠ é€Ÿå’Œå®‰å…¨é˜²æŠ¤
3. **å®šæœŸç»­æœŸ Token** - GitHub Token åˆ°æœŸå‰æ›´æ–°
4. **å®šæœŸå¤‡ä»½** - å°† data ç›®å½•å¤‡ä»½åˆ°æœ¬åœ°

---

## ç›¸å…³æ–‡ä»¶

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `api/routes/sync.ts` | æ‰¹é‡åŒæ­¥ API |
| `api/utils/githubSync.ts` | GitHub API å·¥å…· |
| `src/utils/syncDB.ts` | IndexedDB å·¥å…·ç±» |
| `src/pages/Admin.vue` | ç®¡ç†é¡µé¢ï¼ˆå«åŒæ­¥æŒ‰é’®ï¼‰|
| `src/pages/Editor.vue` | ç¼–è¾‘å™¨ |
| `vercel.json` | Vercel é…ç½®æ–‡ä»¶ |
